---
title: "Lesson 4 - basic R plotting"
author: "Mik Black"
date: "6 November 2015"
output: html_document
---

## R graphics

 - R provides multiple "systems" for producing graphics
 - We're going to focus on the oldest (and arguably easiest) of these: R base graphics
 - These capabilities are included with base R (i.e., what you get when you install the R software), and don't require any additional packages to be loaded.

---

## But first... data summaries

 - One of the reasons for generating plots is to produce a visual summary of the data
    - this helps us (and ohers) to understand key features such as _centre_ and _spread_.
 - In addition to graphical methods, we can also use tools to produce numerical summaries of this information.
    - For example: mean, median, standard deviation, variance, range, min, max, 
    interquartile range...

---

## Examples: non-graphical data summaries

```{r}
## Lets load the data and take a look at it first
data <- read.csv('dummy_data.csv')

## What type of object have we created?
class(data)

## What are its dimensions?
dim(data)

## What are the variable names?
names(data)

## What do the first few rows look like?
head(data)

## What does the start of the BMI variable look like?
## (note the use of the $ operator to access the BMI information from the data object)
head(data$BMI)

## What if we "attach" the data?
attach(data)

## Look, no more $ sign!
head(BMI)

## Summarize the entire data frame
summary(data)

## Summarize just the BMI variable
summary(BMI)

## Calculate the mean of the BMI variable
mean(BMI)

## Oops, we need to get rid of the NA values
mean(BMI,na.rm=T)

## Calculate the mean of the BMI variable
median(BMI, na.rm=T)

## Calculate the standard deviation of the BMI variable
sd(BMI, na.rm=T)
```

---

## Other summaries

 - the above are just a few summaries that can be produced.
    - try: IQR, max, min, range...
 - We can also summarize categorical data using tables via the ```table``` command.
    - ```prop.table``` can then be used to calculate proportions.

```{r}
## Make a table of the ethnicity data
## Note that information class labels can be a good thing...
table(ETHCLASS)

## Include the NA information
table(ETHCLASS, useNA = 'always')

## Gout status
table(GOUT)

## Two-way table of ethnicity and gout
table(ETHCLASS, GOUT)

## Add dimension names
table(ETHCLASS, GOUT, dnn = c("Ethnicity","Gout"))

## We can also flip this via the transpose operator:
t( table(ETHCLASS, GOUT) )

## Use the prop.table command to calculate proportions (cells sum to 1):
prop.table( table(ETHCLASS, GOUT) )

## You can also calculate proportions across rows (rows sum to 1):
prop.table( table(ETHCLASS, GOUT), 1 )

## or down columns (columns sum to 1):
prop.table( table(ETHCLASS, GOUT), 2 )
```

---

## Plotting

 - Need to  use the right sort of plot for the data we have
    - One continuous variable: histogram (```hist```), boxplot (```boxplot```),
    density plot (```plot``` and ```density``` - see below)
    - Two continuous variabes: scatterplot (```plot```)
    - One (or more) cateogircal variables: barplots (```barplot```)
    - One continuous and one (or more) categorical variable: boxplots (```boxplot```)

---

## Histograms - single continuous variable

```{r}
## Generate histogram of age data
hist( AGECOL )
```

## Making plots prettier

 - most base R plotting methods share parameters relating to plot aesthetics (e.g., 
 axis labels/limits, title, text size, plotting colours etc)
 - this makes it very easy to customize plots, and may them look fairly nice

```{r}
## Add title and axis labels
hist( AGECOL , main = "Histogram of Age", xlab = "Age (years)")

##Add some colour...
hist( AGECOL , main = "Histogram of Age", xlab = "Age (years)", col='lightblue')

## Extend y axis
hist( AGECOL , main = "Histogram of Age", xlab = "Age (years)", ylim = c(0,400))
```

---

## Boxplots - single continuous variable

```{r}
## Boxplot of BMI
boxplot(BMI)
```

## Boxplots - continuous & categorical variables

```{r}
## Boxplot of BMI vs Gout Status
boxplot(BMI ~ GOUT, xlab="Gout status", ylab="BMI", main="BMI vs gout status")
```

---

## Scatterplots - two continuous variables

```{r}
## Scatterplot of Age vs BMI
plot(AGECOL, BMI)

## Change plotting symbol, size and colour
plot(AGECOL, BMI, pch = 16, col = "blue", cex = 0.5)

## Use SEX variable to denote colour (has to be numeric, or actual colours)
plot(AGECOL, BMI, col = SEX, pch = 16)
```

---

## Barplots

```{r}
table(ETHCLASS)
barplot( table(ETHCLASS) )

table(GOUT)
table(ETHCLASS, GOUT)
barplot( table(ETHCLASS, GOUT)[-4,] )
t(table( ETHCLASS, GOUT)[-4,] )
barplot( t(table(ETHCLASS, GOUT)[-4,]) )

barplot( t(table(ETHCLASS, GOUT)[-4,]), beside=TRUE)

prop.table( table(ETHCLASS, GOUT)[-4,], 2)
barplot( prop.table(table(ETHCLASS, GOUT)[-4,], 2) )

prop.table( table(ETHCLASS, GOUT)[-4,], 1)
t(prop.table( table(ETHCLASS, GOUT)[-4,], 1) )
barplot( t(prop.table(table(ETHCLASS, GOUT)[-4,], 1)) )
```

---

## Density plots

```{r}
hist(BMI)

## plot(density(BMI))

plot(density(BMI, na.rm=T))
```

---

## Multiple plots per page

```{r}
par(mfrow = c(1, 2))
hist(BMI)
plot(density(BMI, na.rm=T))
```

---

## Saving plots

```{r}
pdf(file='bmi_historgram.pdf', height = 6, width = 6)
hist(BMI)
dev.off()
```



